<!DOCTYPE html>
<html>
 <head>
 <meta charset="utf-8">
 <title>Soundcloud Viz</title>
<!--  <script src='http://connect.soundcloud.com/sdk.js'></script> -->
 <script language="javascript" src="js/creative.js"></script>
<script language="javascript" src="js/canvas.js"></script>
<script language="javascript" src="js/vector.js"></script>
<script language="javascript" src="js/vector_particles.js"></script>
<script language="javascript" src="js/tween.min.js"></script>
<script type="text/javascript" src="js/controlKit.min.js"></script>
	<link rel="stylesheet" href="css/reset.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="css/audio.css" type="text/css" media="screen" />
 </head>
 <body>
   
<script>

var ctx = createCanvas("canvas1");
var slice_ht = 80;
var verticalSlices = height / slice_ht;
var maxHorizOffset = 2;
var img = new Image();
var bakeImg = new Image;
var img_w, img_h, img_scale;
img.src = 'img/people/stevie-nicks1.jpg';
var compressor = 0.8;

img.onload = function() {
    var img_loaded;
    img_w = img.width;
    img_h = img.height;
    img_scale = w/img_w;
   	result = ScaleImage(img.width, img.height, w, h, false);
   	ctx.drawImage(img, 0, 0, img.width, img.height);
   
};


function draw(){
	// 
 //   	var dataURL = canvas1.toDataURL("image/jpeg",compressor);  	
	//ctx.drawImage(bakeImg,0,0);
	// compressor = random(0.6,1);
	// var dataURL = canvas1.toDataURL("image/jpeg",compressor);
	// bakeImg.src = dataURL;
	bakeImg = degrade(canvas1, img);
	for (var i = 0; i < h; i+=1)  {
    var horizOffset = randomInt(-Math.abs(maxHorizOffset), maxHorizOffset);
    ctx.drawImage(bakeImg, 
    0, i * verticalSlices, 
    bakeImg.width, i * verticalSlices + verticalSlices, horizOffset, 
    i * verticalSlices, bakeImg.width, i * verticalSlices + verticalSlices);
}
}

function degrade(canvas, img) {
	//ctx.drawImage(img, 0, 0, img.width, img.height);
	var bakeImg = new Image;
	var compressor = random(0.6,1);
   	var dataURL = canvas.toDataURL("image/webp",compressor);  	
	bakeImg.src = dataURL;
	return bakeImg;
}

</script>
<!--  <script language="javascript" src="js/soundcloud.js"></script> -->
</body>
</html>
