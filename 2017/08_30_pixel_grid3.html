<!DOCTYPE html>
<html>
 <head>
 <meta charset="utf-8">
 <title>Soundcloud Viz</title>

 <script language="javascript" src="../js/creative_coding.js"></script>
 <script language="javascript" src="../js/canvas.js"></script>
 <script language="javascript" src="../js/particle_engine.js"></script>
	<link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../css/audio.css" type="text/css" media="screen" />
 </head>
 <body>

<script>
// was getting annoyed with the same track playing, so changed soundcloud function to play random track
var ctx = createCanvas("canvas1");
var ctx2 = createCanvas("canvas1");

var engine = new particleEngine(10, 10);

var particles = [];
var radius = 150;
var num_particles = 500;
var cols = ['#ffffff', '#50bfe8', '#f06724', '#8cc640'];
var angle = 360/num_particles;
var circ_sz = 300;
var t_size = 150;
var top_offset = 0;

function setup(){
  wall = new pixelGrid(100, 80, 3);
  pixels = wall.pixels;
  engine.grid.spacing.x = Math.round(engine.grid.spacing.x);

for (var i = 0; i < engine.length; i+=1) {
    var p = engine.particles[i];
    p.c = rgba(random(255), 0.8);
    p.speed.y = randomInt(-3, 10);
};

var s1 = 1;
var s2 = -1;
}

function draw(){

	ctx.background(0, 0.1);
	//ctx.save();
  // console.log(engine.grid.spacing.x);
  for (var i = 0; i < engine.length; i+=1) {
    var p = engine.particles[i];
    var s = Sound.mapSound(i, engine.length, 0, 10);
      p.pos.y = (p.pos.y + p.speed.y - s) % h;
      ctx.fillStyle = p.c;
      ctx.fillRect(p.pos.x, p.pos.y, engine.grid.spacing.x, 100);
  }

  // var offset = 30 + Math.sin(frameCount/100) * 10;
  // //
  ctx.fillStyle = rgb(0);
  // // var sz = random(200, 300);
  var sz = Sound.getVol(100, 255);
  // ctx.centreFillRect(w/2 + offset, h/2 + offset, sz);
  // ctx.fillStyle = rgb(sz);
  ctx.centreFillRect(w/2, h/2, sz);

  wall.draw(ctx2, ctx);

}


// function moveParticles(){
//
// 	for (var i = 0; i < particles.length; i++) {
//
// 		p = particles[i];
// 		p.sz = map(audioChannelVolume[p.me%100],0,100, 0, 10);
//
// 		p.x = (p.x + p.speedx)%w;
// 		p.y = (p.y + p.speedy)%h;
//
// 	};
//
// }

javascript:(function(){var script=document.createElement('script');script.onload=function(){var stats=new Stats();document.body.appendChild(stats.dom);requestAnimationFrame(function loop(){stats.update();requestAnimationFrame(loop)});};script.src='//rawgit.com/mrdoob/stats.js/master/build/stats.min.js';document.head.appendChild(script);})()


</script>
 <script language="javascript" src="../js/soundcloud_new.js"></script>
 <script language="javascript" src="../js/pixel_grid.js"></script>
</body>
</html>
